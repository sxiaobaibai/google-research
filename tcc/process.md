# TCC

## Get Embeddings

- embeddings.py
- utils.py

The output gif file is generated by visualize_alignment.py
visualize_alignment.py read embeddings.npy file generated by extract_embeddings.py
embeddings.npy is numpy's object which contains frame, embeddings, and so on.
extract_embeddings.py needs path to tfrecords(dataset)
extract_embeddings.py
  evaluate() -> return embeddings
  embeddings is obtained from get_embeddings_dataset() function from utils.py
  iterator is used in get_embeddings_dataset() function
    we should generate iteretor without using create_one_epoch_dataset() function 
  iterator is generated by create_one_epoch_dataset() function from datasets.py
  and also, path to tfrecords should also be specified.
  get_embeddings_dataset outputs embeddings by using model(algo.model)

### create_one_epoch_dataset
  tfrecord's filename is obtained from get_tfrecords() function.
  sample_and__process() function is used.
  read tfrecord using tf.data.TFRecordDataset() fucntion, and we get tf.dataset
  tf.dataset is preprocessed using sample_and_preprocess() function
  map, batch, prefetch tf.dataset.
  finally return iterator of tf.dataset.



### image__to_tfrecord.py
  list files
  preproces each image.
  return list of object which contain 'video' as key
  ```
  list[num_of_files_] = each object: {'video': frames }
  ```
  frames contain a sequenced video frames.

### visualize_alignment.py
  All embeddings are used for nearest neighbor algorithm.
  if you have N videos, the calculation may be N^2.
  For default, the reference video is set as the first video in embeddings.(the embeddings with id 0)
